{"version":3,"sources":["app/directives/droppable.ts"],"names":["Droppable","Droppable.constructor","Droppable.edit","Droppable.addNew","Droppable.ngOnInit"],"mappings":"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","file":"app/directives/droppable.js","sourcesContent":["import {Directive, OnInit, ElementRef, Input, Injectable} from 'angular2/core';\nimport {DesignService} from '../services/DesignService';\nimport {IFloorElement, FloorElementsService} from '../services/FloorElementsService';\n\ndeclare var jQuery: any;\n\n@Directive({\n  selector: '[droppable-element]'\n})\n\n@Injectable()\nexport class Droppable implements OnInit {\n  designObservable;\n  floorElementsObservable;\n\n  constructor(private elementRef: ElementRef, private DesignService: DesignService, private FloorElementsService: FloorElementsService) {\n    this.designObservable = DesignService.getObservable();\n    this.floorElementsObservable = FloorElementsService.getObservable();\n  }\n\n  edit(elementID, data) {\n    this.FloorElementsService.editElement(elementID, data);\n  }\n\n  addNew(data) {\n    this.FloorElementsService.addElement(data);\n  }\n\n  ngOnInit() {\n    let nativeElement = this.elementRef.nativeElement;\n    this.designObservable.connect();\n\n    jQuery(nativeElement).droppable({\n      activeClass: 'active-droppable',\n      hoverClass: 'active-dropping',\n      drop: (e, dropped) => {\n        let elementID = dropped.draggable.attr('element-id');\n        let position = this.DesignService.getPosition(e, dropped);\n        let floorID = jQuery(e.target).data('id');\n        if (elementID) {\n          this.edit(elementID, {\n            floorID: floorID,\n            elementPositionX: position.x,\n            elementPositionY: position.y\n          });\n        } else {\n          let type = dropped.helper.data('type');\n          this.addNew({\n            floorID: floorID,\n            elementName: 'Untitled',\n            elementType: type,\n            elementPositionX: position.x,\n            elementPositionY: position.y,\n            elementHeight: 0,\n            elementWidth: 19,\n            capacity: 5\n          });\n        }\n      }\n    });\n  }\n};\n"],"sourceRoot":"/source/"}