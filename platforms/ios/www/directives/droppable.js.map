{"version":3,"sources":["app/directives/droppable.ts"],"names":["Droppable","Droppable.constructor","Droppable.edit","Droppable.addNew","Droppable.ngOnInit"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;YAMA;gBASEA,mBAAoBA,UAAsBA,EAAUA,aAA4BA,EAAUA,oBAA0CA;oBAAhHC,eAAUA,GAAVA,UAAUA,CAAYA;oBAAUA,kBAAaA,GAAbA,aAAaA,CAAeA;oBAAUA,yBAAoBA,GAApBA,oBAAoBA,CAAsBA;oBAClIA,IAAIA,CAACA,gBAAgBA,GAAGA,aAAaA,CAACA,aAAaA,EAAEA,CAACA;oBACtDA,IAAIA,CAACA,uBAAuBA,GAAGA,oBAAoBA,CAACA,aAAaA,EAAEA,CAACA;gBACtEA,CAACA;gBAEDD,wBAAIA,GAAJA,UAAKA,SAASA,EAAEA,IAAIA;oBAClBE,IAAIA,CAACA,oBAAoBA,CAACA,WAAWA,CAACA,SAASA,EAAEA,IAAIA,CAACA,CAACA;gBACzDA,CAACA;gBAEDF,0BAAMA,GAANA,UAAOA,IAAIA;oBACTG,IAAIA,CAACA,oBAAoBA,CAACA,UAAUA,CAACA,IAAIA,CAACA,CAACA;gBAC7CA,CAACA;gBAEDH,4BAAQA,GAARA;oBAAAI,iBAgCCA;oBA/BCA,IAAIA,aAAaA,GAAGA,IAAIA,CAACA,UAAUA,CAACA,aAAaA,CAACA;oBAClDA,IAAIA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,CAACA;oBAEhCA,MAAMA,CAACA,aAAaA,CAACA,CAACA,SAASA,CAACA;wBAC9BA,WAAWA,EAAEA,kBAAkBA;wBAC/BA,UAAUA,EAAEA,iBAAiBA;wBAC7BA,IAAIA,EAAEA,UAACA,CAACA,EAAEA,OAAOA;4BACfA,IAAIA,SAASA,GAAGA,OAAOA,CAACA,SAASA,CAACA,IAAIA,CAACA,YAAYA,CAACA,CAACA;4BACrDA,IAAIA,QAAQA,GAAGA,KAAIA,CAACA,aAAaA,CAACA,WAAWA,CAACA,CAACA,EAAEA,OAAOA,CAACA,CAACA;4BAC1DA,IAAIA,OAAOA,GAAGA,MAAMA,CAACA,CAACA,CAACA,MAAMA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,CAACA;4BAC1CA,EAAEA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA;gCACdA,KAAIA,CAACA,IAAIA,CAACA,SAASA,EAAEA;oCACnBA,OAAOA,EAAEA,OAAOA;oCAChBA,gBAAgBA,EAAEA,QAAQA,CAACA,CAACA;oCAC5BA,gBAAgBA,EAAEA,QAAQA,CAACA,CAACA;iCAC7BA,CAACA,CAACA;4BACLA,CAACA;4BAACA,IAAIA,CAACA,CAACA;gCACNA,IAAIA,IAAIA,GAAGA,OAAOA,CAACA,MAAMA,CAACA,IAAIA,CAACA,MAAMA,CAACA,CAACA;gCACvCA,KAAIA,CAACA,MAAMA,CAACA;oCACVA,OAAOA,EAAEA,OAAOA;oCAChBA,WAAWA,EAAEA,UAAUA;oCACvBA,WAAWA,EAAEA,IAAIA;oCACjBA,gBAAgBA,EAAEA,QAAQA,CAACA,CAACA;oCAC5BA,gBAAgBA,EAAEA,QAAQA,CAACA,CAACA;oCAC5BA,aAAaA,EAAEA,CAACA;oCAChBA,YAAYA,EAAEA,EAAEA;oCAChBA,QAAQA,EAAEA,CAACA;iCACZA,CAACA,CAACA;4BACLA,CAACA;wBACHA,CAACA;qBACFA,CAACA,CAACA;gBACLA,CAACA;gBAtDHJ;oBAACA,gBAASA,CAACA;wBACTA,QAAQA,EAAEA,qBAAqBA;qBAChCA,CAACA;oBAEDA,iBAAUA,EAAEA;;8BAmDZA;gBAADA,gBAACA;YAADA,CAvDA,AAuDCA,IAAA;YAvDD,iCAuDC,CAAA;YAAA,CAAC","file":"app/directives/droppable.js","sourcesContent":["import {Directive, OnInit, ElementRef, Input, Injectable} from 'angular2/core';\nimport {DesignService} from '../services/DesignService';\nimport {IFloorElement, FloorElementsService} from '../services/FloorElementsService';\n\ndeclare var jQuery: any;\n\n@Directive({\n  selector: '[droppable-element]'\n})\n\n@Injectable()\nexport class Droppable implements OnInit {\n  designObservable;\n  floorElementsObservable;\n\n  constructor(private elementRef: ElementRef, private DesignService: DesignService, private FloorElementsService: FloorElementsService) {\n    this.designObservable = DesignService.getObservable();\n    this.floorElementsObservable = FloorElementsService.getObservable();\n  }\n\n  edit(elementID, data) {\n    this.FloorElementsService.editElement(elementID, data);\n  }\n\n  addNew(data) {\n    this.FloorElementsService.addElement(data);\n  }\n\n  ngOnInit() {\n    let nativeElement = this.elementRef.nativeElement;\n    this.designObservable.connect();\n\n    jQuery(nativeElement).droppable({\n      activeClass: 'active-droppable',\n      hoverClass: 'active-dropping',\n      drop: (e, dropped) => {\n        let elementID = dropped.draggable.attr('element-id');\n        let position = this.DesignService.getPosition(e, dropped);\n        let floorID = jQuery(e.target).data('id');\n        if (elementID) {\n          this.edit(elementID, {\n            floorID: floorID,\n            elementPositionX: position.x,\n            elementPositionY: position.y\n          });\n        } else {\n          let type = dropped.helper.data('type');\n          this.addNew({\n            floorID: floorID,\n            elementName: 'Untitled',\n            elementType: type,\n            elementPositionX: position.x,\n            elementPositionY: position.y,\n            elementHeight: 0,\n            elementWidth: 19,\n            capacity: 5\n          });\n        }\n      }\n    });\n  }\n};\n"],"sourceRoot":"/source/"}